name: W3C Validation
on: [push]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
      
      - name: Validate via API
        run: |
          curl -s "https://validator.w3.org/nu/?out=json&doc=https://fpsthirty.github.io/frecklesmusic/" > docs/w3c-results.json
          jq -e '.messages[] | select(.type == "error")' docs/w3c-results.json && exit 1 || exit 0
      
      - name: Upload Results
        uses: actions/upload-artifact@v4
        with:
          name: w3c-validation-results
          path: docs/w3c-results.json